{% extends "account/base_entrance.html" %}
{% load i18n %}
{% load allauth account %}

{% block head_title %}
  {% trans "Change Password" %}
{% endblock head_title %}

{% block content %}
  <div class="space-y-6">
    {% if token_fail %}
      <!-- Error State -->
      <div class="text-center">
        <div class="flex justify-center mb-6">
          <div class="rounded-full bg-red-100 dark:bg-red-900/30 p-6">
            <svg class="h-16 w-16 text-red-600 dark:text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
            </svg>
          </div>
        </div>

        <h2 class="text-3xl font-serif font-bold text-gray-900 dark:text-white">
          {% trans "Invalid Reset Link" %}
        </h2>
        <p class="mt-4 text-sm text-gray-600 dark:text-gray-400 max-w-md mx-auto">
          {% trans "This password reset link is invalid or has expired. Please request a new one." %}
        </p>
      </div>

      <div>
        <a href="{% url 'account_reset_password' %}" class="inline-flex items-center justify-center w-full rounded-xl px-6 py-3 text-sm font-bold uppercase tracking-wider transition-all duration-300 bg-gradient-to-r from-gold-400 to-gold-600 text-white shadow-lg shadow-gold-500/20 hover:from-gold-500 hover:to-gold-700 hover:shadow-gold-500/40 hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gold-500">
          {% trans "Request New Reset Link" %}
        </a>
      </div>
    {% else %}
      <!-- Page Title -->
      <div class="text-center">
        <h2 class="text-3xl font-serif font-bold text-gray-900 dark:text-white">
          {% if token_fail %}
            {% trans "Invalid Reset Link" %}
          {% else %}
            {% trans "Set New Password" %}
          {% endif %}
        </h2>
        <p class="mt-2 text-sm text-gray-600 dark:text-gray-400">
          {% trans "Please enter your new password below" %}
        </p>
      </div>

      <!-- Password Reset Form -->
      {% url 'account_reset_password_from_key' uidb36=uidb36 key=key as action_url %}
      {% element form form=form method="post" action=action_url tags="entrance,password_reset_from_key" %}
        {% slot body %}
          {% csrf_token %}
          {% element fields form=form unlabeled=False %}
          {% endelement %}
        {% endslot %}
        {% slot actions %}
          <div class="space-y-4">
            {% element button type="submit" tags="prominent,password_reset_from_key" %}
              {% trans "Change Password" %}
            {% endelement %}

            <!-- Back to Login -->
            <div class="text-center">
              <a href="{% url 'account_login' %}" class="text-sm text-gold-600 dark:text-gold-400 hover:text-gold-700 dark:hover:text-gold-300 transition-colors font-medium inline-flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                </svg>
                {% trans "Back to Sign In" %}
              </a>
            </div>
          </div>
        {% endslot %}
      {% endelement %}
    {% endif %}
  </div>
{% endblock content %}
